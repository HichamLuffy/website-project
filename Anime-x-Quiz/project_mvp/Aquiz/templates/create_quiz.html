{% extends "layout.html" %}
{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Make Quiz</h3>
                </div>
                <div class="card-body">
                    <form id="quiz-form" method="POST", action="">
                        {{ form.hidden_tag() }}
                        <div class="form-group">
                            {{ form.title.label(class="form-label") }}
                            {{ form.title(class="form-control") }}
                        </div>
                        <div class="form-group">
                            {{ form.category.label(class="form-label") }}
                            {{ form.category(class="form-control") }}
                        </div>
                        <div class="form-group">
                            {{ form.level.label(class="form-label") }}
                            {{ form.level(class="form-control") }}
                        </div>
                        <div class="form-group" id="num-questions-group">
                            {{ form.num_questions.label(class="form-label") }}
                            {{ form.num_questions(class="form-control") }}
                        </div>
                        <div id="questions-fields" style="display: none;">
                            <!-- Question-related fields -->
                            {% for i in range(1, 11) %}
                            <div class="question-group" id="question{{ i }}-group" style="display: none;">
                                <h5>Question {{ i }}</h5>
                                <div class="form-group">
                                    <label for="question{{ i }}">Question</label>
                                    <input type="text" name="question{{ i }}" id="question{{ i }}" class="form-control">
                                </div>
                                {% for j in range(1, 5) %}
                                <div class="form-group">
                                    <label for="option{{ i }}-{{ j }}">Option {{ j }}</label>
                                    <input type="text" name="option{{ i }}_{{ j }}" id="option{{ i }}-{{ j }}" class="form-control">
                                </div>
                                {% endfor %}
                                <div class="form-group">
                                    <label for="correct-option{{ i }}">Correct Option</label>
                                    <select name="correct_option{{ i }}" id="correct-option{{ i }}" class="form-control">
                                        <option value="1">Option 1</option>
                                        <option value="2">Option 2</option>
                                        <option value="3">Option 3</option>
                                        <option value="4">Option 4</option>
                                    </select>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        <div class="form-group">
                            <button type="button" id="next-btn" class="btn btn-primary">Next</button>
                        </div>
                        <div class="form-group" id="submit-btn-group" style="display: none;">
                            {{ form.submit(class="btn btn-primary", id="submit-btn") }}
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function() {
        $('#next-btn').click(function() {
            var numQuestions = parseInt($('#num_questions').val());
            var title = $('#title').val().trim(); // Get the title value
            if (title === "") { // Check if title is empty
                alert('Please enter a title.');
                return false; // Prevent form submission if title is empty
            }
            $('#next-btn').text('Done');
            if (numQuestions >= 1 && numQuestions <= 10) {
                $('#num-questions-group').hide();
                $('#questions-fields').show();
                // Show question fields based on the selected number of questions
                for (var i = 1; i <= numQuestions; i++) {
                    $('#question' + i + '-group').show();
                }
                // Check if any question or option fields are empty
                var allFieldsFilled = true;
                for (var i = 1; i <= numQuestions; i++) {
                    var question = $('#question' + i).val().trim();
                    if (question === "") {
                        allFieldsFilled = false;
                        break;
                    }
                    for (var j = 1; j <= 4; j++) {
                        var option = $('#option' + i + '-' + j).val().trim();
                        if (option === "") {
                            allFieldsFilled = false;
                            break;
                        }
                    }
                }
                if (allFieldsFilled) {
                    $('#submit-btn-group').show();
                }
            } else {
                alert('Please select a number of questions between 1 and 10.');
            }
        });
    });
</script>
{% endblock %}
