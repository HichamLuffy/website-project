{% extends "layout.html" %}
{% block content %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/8.4.5/swiper-bundle.min.js"></script>
<div class="content">
    <div class="content-text">
        <h1> Test your anime<br> knowledge with<br> AQZ!</h1>
        <p>Challenge yourself with our anime quizzes and see how much you know.</p>
        <a href="/quiz" class="bn3637 bn37">Play</a>
    </div>
    <div class="rectangle-overlay"></div>
</div>
<div class="content2">
    <div class="text-container">
        <h5>Discover <span class="movie-night">AQZ</span></h5>
        <p>Welcome to AQZ, the ultimate Anime Quiz experience.<br>
        Choose from a variety of categories including openings, characters, logos, and more and put your knowledge to the test.<br>
        Challenge yourself and see how well you know your favorite anime!</p>
        <!-- <button class="btnaa">Start now</button> -->
    </div>
    <div class="image-container">
        <div class="gradient-overlay"></div>
        <img src="../static/images/content2.png" alt="Quiz">
    </div>
</div>
<section class="main-section">
  <div class="cards">
    <div class="information">
      <h5>Explore Anime Quiz <span class="movie-night">categories</span></h5>
      <p>Choose from a variety of questions such as voice, eyes, smile, clothing, hair, and weapons to test your anime knowledge.</p>
      <h5><span class="movie-night">Create</span> Your Own Quizzes</h5>
      <p>Login to post your own quizzes, create polls, and challenge others to test their anime knowledge.</p>
      <h5>Customize Your <span class="movie-night">Profile</span></h5>
      <p>Personalize your profile, earn badges, and showcase your anime quiz achievements to the community</p>
    </div>
    <div class="swiper">
      <div class="swiper-wrapper">
        <div class="swiper-slide">
          <h2>Guess Characters From Face</h2>
        </div>

        <div class="swiper-slide">
          <h2>Guess Characters From Place</h2>
        </div>

        <div class="swiper-slide">
          <h2>Guess Characters From Laugh</h2>
        </div>

        <div class="swiper-slide">
          <h2>Guess Characters From Eye</h2>
        </div>
      </div>
    </div>
  </div>

  <ul class="circle-back">
    <li></li>
    <li></li>
    <li></li>
  </ul>
</section>
<div class="updates-sectionoverlay">
    <div class="updates-section">
        <div class="updates-content">
            <h2 class="updates-title">INCOMING UPDATES AND MORE FEATURES AND FUN</h2>
            <ul class="updates-list">
                <li>Now you can follow your friends and see their status.</li>
                <li>Now you can like, comment on, add to favorites, and share quizzes with friends.</li>
                <li>New Quiz Categories: guess character by clothes, guess character by hair</li>
                <li>Mobile App: Introducing the Anime x Quiz mobile app! Access quizzes and connect with the community on the go. Download now!</li>
            </ul>
        </div>
    </div>
</div>
<!-- Team Section -->
<div class="team-section">
    <h6>Discover</h6>
    <h2>OUR TEAM</h2>
    <p>Meet the creators and moderators of the Anime Quiz website.</p>
    <div class="team-members">

        <!-- Team Member Hicham FHAD -->
        <div class="team-member">
            <img src="../static/images/hicham.jpeg" alt="Hicham FHAD">
            <h3>Hicham FHAD</h3>
            <p>Backend and UX/UI Designer. Merging technical prowess with UX/UI finesse to craft seamless Anime Quiz experiences.</p>
            <div class="social-links">
                <a href="https://www.linkedin.com/in/hicham-fhad-7b9070263/" target="_blank">
                    <img src="../static/images/linkedin-icon.png" alt="LinkedIn">
                </a>
                <a href="https://github.com/HichamLuffy" target="_blank">
                    <img src="../static/images/github-icon.png" alt="GitHub">
                </a>
            </div>
        </div>

        <!-- Team Member Loubna ALFIDI -->
        <div class="team-member">
            <img src="../static/images/loubna.jpeg" alt="Loubna ALFIDI">
            <h3>Loubna ALFIDI</h3>
            <p>Frontend Developer & Mockup Maker. Bringing designs to life.</p>
            <div class="social-links">
                <a href="https://www.linkedin.com/in/loubna-alfidi-94a092219/" target="_blank">
                    <img src="../static/images/linkedin-icon.png" alt="LinkedIn">
                </a>
                <a href="https://github.com/Loubna-ALFIDI" target="_blank">
                    <img src="../static/images/github-icon.png" alt="GitHub">
                </a>
            </div>
        </div>

    </div>
</div>

<div class="comments-section">
    <button id="left-arrow" class="arrow">&lt;</button> <!-- Left arrow -->
    <div class="comments-container" id="comments-container">
        <!-- Comments will be dynamically added here -->
    </div>
      <form id="comment-form" class="comment-form" method="POST">
          <textarea id="comment-text" name="comment-text" placeholder="Add your comment"></textarea>
          <input type="number" id="comment-rating" name="comment-rating" min="1" max="5" placeholder="Rating (1-5)">
          <button type="submit">Submit</button>
      </form>
    <button id="right-arrow" class="arrow">&gt;</button> <!-- Right arrow -->
    <div class="dots-container" id="dots-container"></div> <!-- Container for dots -->
  </div>

<!-- FAQ Section -->
<div class="faq-section">
    <h2 class="faq-title">FAQs</h2>
    <p class="faq-subtitle">Find answers to commonly asked questions about using our site, the scoring system, and earning badges.</p>
    
    <div class="faq-container">
        <div class="faq-item">
            <h3>How do I use the site?</h3>
            <p>To use our site, simply choose a category and start answering anime quiz questions. You can also login to post your own quizzes, make polls, and interact with other users.</p>
        </div>
        
        <div class="faq-item">
            <h3>How does scoring work?</h3>
            <p>Correct Answer: +10 points<br>
            Incorrect Answer: 0 points<br>
            Award bonus points based on how quickly the user submits their response.<br>
            Time Limit for Full Speed Bonus: 10 seconds<br>
            Full Speed Bonus: +5 points<br>
            Partial Speed Bonus: Linearly decrease bonus points for responses submitted between 10 to 20 seconds. -5points</p>
        </div>
        
        <div class="faq-item">
            <h3>How can I earn badges?</h3>
            <p>You can earn badges by reaching certain milestones, such as reaching a specific level or achieving a high score. Badges will be displayed on your profile.</p>
        </div>
        
        <div class="faq-item">
            <h3>How do I customize my profile?</h3>
            <p>To customize your profile, go to your account settings. From there, you can change your profile picture, update your bio, and personalize your profile.</p>
        </div>
    </div>
</div>


<script>
function fetchAndAppendComments() {
  fetch('/comments')
      .then(response => response.json())
      .then(comments => {
          const commentsContainer = document.getElementById('comments-container');
          commentsContainer.innerHTML = ''; // Clear existing comments
          comments.forEach(comment => {
              const commentBox = document.createElement('div');
              commentBox.classList.add('comment-box');
              // Update the innerHTML structure here
              commentBox.innerHTML = `
                  
                  <div class="rating">${generateStars(comment.rating)}</div>
                  <div class="comment-text">${comment.text}</div>
                  <div class="user-info">
                      <img src="${comment.profile_pic}" alt="${comment.username}" class="profile-pic">
                      <span class="username">${comment.username}</span>
                  </div>
  
              `;
              commentsContainer.appendChild(commentBox);
          });
      })
      .catch(error => {
          console.error('Error fetching comments:', error);
      });
}
// Fetch comments when the page initially loads

document.addEventListener('DOMContentLoaded', fetchAndAppendComments);

    var swiper = new Swiper(".swiper", {
    effect: "cards",
    grabCursor: true,
    initialSlide: 2,
    speed: 500,
    loop: true,
    rotate: true,
    mousewheel: {
    invert: false,
  },
});

// Handle form submission
document.getElementById('comment-form').addEventListener('submit', function(event) {
    event.preventDefault(); // Prevent default form submission

    // Get comment text and rating from the form
    const commentText = document.getElementById('comment-text').value;
    const commentRating = document.getElementById('comment-rating').value;

    // Send the comment data to the server
    fetch('/add-comment', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            text: commentText,
            rating: commentRating
        })
    })
    .then(response => response.json())
    .then(comment => {
        // Fetch and append comments again after successful submission
        fetchAndAppendComments();
        // Clear the form
        document.getElementById('comment-text').value = '';
        document.getElementById('comment-rating').value = '';
    })
    .catch(error => {
        console.error('Error adding comment:', error);
    });
});

// Function to generate star icons based on rating
function generateStars(rating) {
    let starsHtml = '';
    for (let i = 0; i < 5; i++) {
        if (i < rating) {
            starsHtml += '<span class="star full">★</span>'; // Full star
        } else {
            starsHtml += '<span class="star empty">☆</span>'; // Empty star
        }
    }
    return starsHtml;
}


// Smooth horizontal scrolling
let isScrolling = false;

document.getElementById('comments-container').addEventListener('mousedown', (e) => {
    isScrolling = true;
    startX = e.pageX - document.getElementById('comments-container').offsetLeft;
    scrollLeft = document.getElementById('comments-container').scrollLeft;
});

document.getElementById('comments-container').addEventListener('mouseleave', () => {
    isScrolling = false;
});

document.getElementById('comments-container').addEventListener('mouseup', () => {
    isScrolling = false;
});

document.getElementById('comments-container').addEventListener('mousemove', (e) => {
    if (!isScrolling) return;
    e.preventDefault();
    const x = e.pageX - document.getElementById('comments-container').offsetLeft;
    const walk = (x - startX) * 2; // Change the multiplier for faster/slower scrolling
    document.getElementById('comments-container').scrollLeft = scrollLeft - walk;
});

document.addEventListener('DOMContentLoaded', function() {
    const container = document.getElementById('comments-container');
    const leftArrow = document.getElementById('left-arrow');
    const rightArrow = document.getElementById('right-arrow');
    
    // Fetch and append comments initially
    fetchAndAppendComments();

    // Assuming fetchAndAppendComments also initializes dots based on comments
    // For simplicity, here's a placeholder function to update active dot
    function updateActiveDot(index) {
        const dots = document.querySelectorAll('.dot');
        dots.forEach(dot => dot.classList.remove('active'));
        dots[index].classList.add('active');
    }

    leftArrow.addEventListener('click', () => {
        // Scroll to the previous comment
        container.scrollBy({ left: -container.offsetWidth, behavior: 'smooth' });
        // Update active dot here based on scroll position or index
    });

    rightArrow.addEventListener('click', () => {
        // Scroll to the next comment
        container.scrollBy({ left: container.offsetWidth, behavior: 'smooth' });
        // Update active dot here based on scroll position or index
    });

    // Optional: Listen to scroll event to update dots based on current view
});

// Ensure fetchAndAppendComments() and generateStars() are implemented as discussed


</script>
{% endblock %}
